#!/bin/bash

# Check if both environment name and Conda path are provided
if [ "$#" -ne 2 ]; then
    echo "Usage: $0 <env_name> <path_to_conda>"
    exit 1
fi

ENV_NAME=$1
CONDA_PATH=$2

# Manually source Conda configuration
source "$CONDA_PATH/etc/profile.d/conda.sh"

# Create conda environment if it doesn't exist
if ! conda info --envs | grep -wq $ENV_NAME; then
    conda create -n $ENV_NAME python=3.8 -y
fi

# Activate the environment
conda activate $ENV_NAME
echo "Active Conda environment: $CONDA_DEFAULT_ENV"

# Install PyTorch depending on the OS
OS=$(uname)
if [ "$OS" == "Darwin" ]; then
    # MacOS
    conda install pytorch::pytorch torchvision torchaudio -c pytorch
elif [ "$OS" == "Linux" ]; then
    # Linux
    conda install pytorch torchvision torchaudio pytorch-cuda=12.1 -c pytorch -c nvidia
else
    echo "Unsupported OS: $OS"
    exit 1
fi

# Install other requirements
pip install -r requirements.txt -y

# Check if demo_models exists
if [ ! -d "demo_models" ]; then
    mkdir demo_models && cd demo_models

    # Download and setup ASR model
    mkdir asr && cd asr
    gdown --id 1BeT7m_5qv19Sb5yrZ2zhKu6fEprUoB9N -O config.json
    gdown --id 15xQiVew2SatAL_7E5Hh30hya8x7tyGb_ -O pytorch_model.bin
    cd ..

    # Download other models
    gdown --id 1GQIXgCSF3Usiuy5hkxgOl483RPX3f_SX -O language.pt
    gdown --id 1wWrmopvvdhlBw-cL7EDyih9zn_IJu5Wr -O acoustic.pt
    gdown --id 1LPchbScA_cuFx1XoNxpFCYZfGoJCfWao -O multimodal.pt
fi

echo "ttttttttffttttttttttttt11111111111111iiiiiiiiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;;;;:::::::::::::::,,,,,,,,,,,,,,,.......,,,,,,,,,,,:,::t:....,...,.11ii1i111fLCCCG008
tttttttttttttttttttt11111111111111iiiiiiiiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;;;;;;::::::::::::::,,,,,,,,,,,,,.,.........,,.,,,,,,,,,,::t,..........,88800800000GCCCLt
ttttttttttttttttttt1111111111iiiiiiiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::::::::::,,,,,,,,,,,,,.................,,,,,,,,,::t:..........,;;;;;;;;;iiiiiiit
ttttttttttttttttt111111111111iiiiiiiiiiiii;i;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::::::,,,,,,,,,,,,,....................,,,,,,,,,1;...........:::::::;;;;;;;;if
tttttttttttt1ttt1111111111iiiiiiiiiiiiii;i;;;;;;;;;;;;;;;;;;;;;;;;;;i;i;;;;;;;;;;::::::::,,,,,,,,,,,,.....................,,,,,,,,i;...........CCGG0888888888880
tt1t111tttt11t1111111111iiiiiiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;;iiii;;ii1111iiii;;ii;;::::::,,,,,,,,.........................,,,,,,,,i;...........Li;;;;;;;i;;;;;;i
1111111111t111111111iiiiiiiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;i;;iiiiii11ii1ii11iiii;iiii;:::::,,,,,,.............................,..,,;;...........;,,,,:::::::::;;t
111111111111111111iiiiiiiiiiii;;i;i;;;;;;;;;;;;;;;;;;;;;iiiiiii11t1LCCf11LGGCftiii;;;1;;::::,,,,..................................:;...........iii1tffCCGGG00080
1111111111111111iiiiiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;;;;;iiii111ffL088888888800GGCfft1ti1;::::,,,,..................................:;........ ..f;;;;;;iii;;;;;;;
11111111111111iiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;i1tLC88@@@@@@@@@@@@@@@@@@0CCGt1t1;:::,,,...................................,;...  ... ..i,,,,,,,,,,,::::;
11111111111iiiiiiiiiii;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;i1C0G808@@@@@@@@@@@@@@@@@@@@@00000Gt1;;:,,....................................;...   .  ..,,.,,,,,:::;;ii1f
11111111111iiiiiiiii;;;;;;;;;;;;;;::::;;:;;;;;;;;ii111000@@@@@@@@@@@@@@@@@@@@@@@@@@@@8880C1i;;:,...................................;...   .  ..tCLLLfLfftttt1111
11111111111iiiiiii;;;;;;;;;;;;;;:::::::::::;;;;;ii1t08@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8f1i;,...................................;...      ..:.,,,,,,,,,,,::::
1111111111iiiiiii;;;;;;;;;;;::::::::::::::::;;;tC0888@@@@@@@@@@@@@@@@@@@888888888888@@@@@@@@0f;::..................................;...  .   ........,,,,,,::::;
1111111111iiii;;;;;;;;;;;;::::::::::::::::::;it0008@@@@@@@@@@@@@@@000GGCLLLfffLLLLCG008@@@@@@8Ct:,.................................;. . ..   . .t1ttffffftttfttt
iiiiiiii11i;iii;;;;;;;:::::::::::::::::::::;ift080@@@@@@@@@@@@@80GGCCLftt11tttt1ftfGCGGGG8@@@@0t:,.................................;.   ..  .  .....,,,,,,,,:,,:
iiiiiiiiii;;;;;;;;;;;:::::::::::::,:::::::;;1tf8@@@@@@@@@@@@@@8GCLCCLft111tLL1;;;iLCCLffff0@@@@01,.................................;        .  .............,,,,
iiiiiiiiii;;;;;;;;;::::::::::,:,,,,,::;;ii11L08@8@@@@@@@@@@@@0GCCCLfftttttCt1i;ii11tttttfffC8@@8;:.................................;       ..   LLLLCCCCCCCCGCG0
iiiiiiiiii;;;;;;;::::::::,,,,,,,,,,,:iii;iii10@@@@@8@@@@@@@@8GCCLCLLfftftf1i1111111111tttfffL8@@f:,................................;            ,,.,,,,,,,,,::::
iiiiiiiiii;;;;;;:::::::,,,,,,,,,,,,,,L::;;iG88@@@8@@@@@@@@@80CLLLfffffff111i111ii;;i1111ttttf0@@8;:................................;.           ............,,,,
iiiiiiiiii;;;;;::::::::,,,,,,,,,...,.,1:i1L0G8@@@8G08@@@88800@@@@@8Gft1f;iii;;ii1L00000Cftttf0@@@G:,...............................;.         . CCCLCGCGGGGGGGGG
iiiiiiiii;;:;::::::::,,,,,,,,,........,i;:C0L8@0@80tC8@@88@@0GG0GCCCLfi::;;:,:LfG00GGLCG08Lft0@@@@i,,..............................;.   .     ..;,,,,,,,::::::::
iiiiiiiii;:;;:::::::,,,,,,,,,.........,;1:;L8C@G8f88i@@@8@GLtt111111ii;;;:::,:;;ii11iiiiiiLGff@@@@t,,.................;:,..........;.   .     ..,............,,,
iiiiiiiii;:::::::,,,,,,,,,.,...........,:ti;G088Gf08C@@80LffC0GCCGGLft11i;;:i1tfLGCLCtfL111tLf0@@@t;:,...............t1;,..........;.         ..tLCLLCCCGGGGGGGG
iiii;;;;;::::::::,,,,,,,,,............;...,:i88Lit8t;@@0CLC08Lt8@@:LtLCL1i;ifLt1f:t888;C0Lt1tLt@@@Gt;,..............:ti;,. ........;,         ..;..,,,,,,,,,,:::
ii;;;i;i;::::::::,,,,,,,...............i,:i0@;,.;iCtC@0CfLG00GG0GGCCffGf1i:i1LffLffffftfLLf1itt0@80fi,..............i1;:, .,.......;:         . ..............,,
i;;;;;;;i::::::,,,,,,,,............................f18CLCCLtttttttffGCLf1,;i111;i1t11i1t1;;111tt0011::..............i1:,.  .,......;:         . ;LCCCCCGGGGG0000
;;;i;;;;;::::::,,,,,,,.......... . ........    ....,;iLLf111tffttt1tfLCti.i1iiii;::;;;i;::;ii1tfCCi:;,..............,t;,..  :......;;. .  ..  . ..,,,,,,,:::::::
;;;;;;;;;::::,,,,,,,,,,........                    ..iLff1i;;;;ii;;iLLL1;:i1i11i::,,,,...,:;i1ffff:,,,...............t1:... :;.....;;  .  .   . ...............,
;;;;;;;;;:,,:,,,,,,,,,........                      .iLLti;::::,,;ft1Lt;::ii;;i11;:,....,,:;itfff:,,,.................t:.  .,::,...;;. .  .  ....LCCCCCGGG0GGGG0
;;;;;;;;;,::,,,,,,,,,,........                       ;Lf1;::,.,:;it1tfi.  ;1i11t;;;;:.  .,,;itfL1,,...................1:.   .,:,,..;i...  .  ....,,,,,,,,,,:::::
;;;;;;;;:,,,,,,,,,,.........                         :tf1;:,:;;i1tfffffiiitttft1111;ii:,::;;1tfft,,...................,1,     .,,,.:i...  .  ..............,,...
;;;;;;;;:,,,,,,,,,.........                          Lt1i;::;;i1ttfttt11i;;;i1ii;i11111;:;;ii1t11,,,..................,f1:,,. ..,,,:i... .. .. ..CffLLLCCCCGCCGG
;;;;;;;;,,,,,,,,,,........                           ;1;;:::1ii1111iii;;::,::,,:;iiiiii1::::;1fi,,,,,,............,,,::::;;::::::;::1... .. .. ..,,,,,,,::::::::
;;;;;;;;,,,,,,,,,........                            ;1;:::,;i1fLtftii;;:, ,:;:,t1ift1;;,::;itC:,,,,,,,,,.,:;;i;:::,,.....,,::,..,:;1,,. .. .. ..........,,,,,,,
;;;;;;;;,,,,,,,,,,........                          ..t;:::,,:itC8Li            ;f0L1;;,,;;itCi::,,,,,:i;:,,,...,,,.       .,::,...::;,  .  .. ..tLLLLCLfLCLLLCC
;;;;;;;;,,,,,,,,,,..........                      ....ii;:::,:;ifCGii :    .   ;fCL1i;;,:;i1CG;:::::1::,,.    ..,::,,..     ..:;;:,,:;i...  .. ..i.,,,,,,,,,::::
;;;;;;;;,,,,,,,,,,..........                  ......,,,i1;:;::1111tffftft111i;1t1i;iii,:ii1Lf;;;;;:;:..       .:1i;ii;;:,,....,,:;;;;;;i.. ..  ..L,,,,,,,,,,,:::
i;;;;;;;,,,,,,,,,,................. ...........,,,:::::;;ti;1;ii11ti;;::,::,,,,:;;ii;::i1tGGt1iii;;;i,     :t;;;iii;,     ..,,,,,,,,;;i11: ,...,,1LLLLLfftt111i1
i;;;;;;:,,,,,,,,,,,,.....................,,,,,:::::;;;ii1L8t11ii11ii;;;;;::;;;;:;;::::itC@@@@@@C1iiiiii1Li;::::::,,,.       ...,,::,::;i1t1,: ,,,;t;;;::;;:;;;;;
;;;;;;;:,,,,,,,,,,,,,,,...,.,,.,,,,,,,,,,::::;;;;iif@@@@@@@@0Lti111ii;::,,,,,,:::;::itLGG@@@@@@@@f1111f1;:::,.......         ..,.,,,,::;;;1t1,,,,;@@@@@@@@@@@@@@
;;;;;;;:,,,,,,,,,,,,,,,,,,,,,,,,,:::::::;;;iiiiif@@@@@@@@@@@@0GC111i;;;:,,,,::::::ifC0GLt;.:t@@@@@8tfi;;,,..     .,..         .,,,,,,::::;i1111;,;@@@@@@@@@@@@@@
i;i;i;;:,,:::::::::::::::::::::::;;;;;;iiii1110@@@@@@@@@@@@@@0GGGf1ii::,..,,:::;itGCG0@ti.  . @@@@@8t:,.       :1;;i1:        ...,,:,,,::::ii;;tt:@@@@@@@@@@@@@@
iiiiiii::::::::::::::::::;;;;;;;;iiiii111tttC@@@@@@@@@@@@8@@@0GfttLfi1i;::,::;1LLftLC0@@;   .  8@@@88f;. :t1i;;;:;;:,          ....,:,,,::;;;;iitt@@@@@@@@@@@@@@
iiiiiii:::::::::::;;;;;;;;iiiiiii111ttL0@@@@@@@@@@@@@@@@@@@@80C1i;iii1tfftttti111ttfG@@0G, .,  :@@@@8@8t1i;,.......,,,            .,,,:,,:::::ii11tC@@@@@@@@@@@@
iiiiiii:::;;;;;;;;;;;;iiiii1111tL@@@@@@@@@@@@@@@@@@@@@@@@@@@@8L1ii;;;;iii;:;1111f0@@@@@i, C::  ,G@@@@@i:;;,,       ...            . .,,::::::;;;1ttff0@@@@@@@@@@
11iiiii;;;;;;;;;;;iiiiii11tf8@@@@@@@@@@@@@@@@@@@@@@@@@@0C8@@@@@@@@@@@@@@@@@@@@@@@@@@@@::  : ,..:@@@@@@C:::.       ,,,,,.          ..,..,,,:;,;;:;i1ffff8@@@@@@@@
111i11i;;;;;;;iiiiii111t0@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ti11t@@@@@@@@@@@@@@@@@@@@@@88Ct   :ift88@@@@@@@@@@;,i1i;;::;;;:          . .,,,,.,,:;;;i;i;;11f1tC8@@@@@@
111111i;iiiiiiii111tG@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@088GLtttf8@@@@@@@@@@@@i .:tf; ,@@@@@@@@@@@@@@@@@@i;;:,......,.           ..,,,:,,:i;::;i;i11;f1tfG0@@@@@
111111iiiiiiii11G@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   t@@@@@@@@@@@@@@@@@@@@i,::,.     ..           .,  ,:;,,::,,;:;i111t1tfLCG00Cf
ttttt11iii1111L@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@G@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;:,.              ,.. :.. .,,.::,.,..,::i;111ttfGG000
tttttt1ii111t8@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@0f0@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8:i        . ,. ....:,,,...,....,:11tt1tLGG00
fttttt111ttf@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@t         . ,::;:;1;ii.,.    .:i1ttLfLCGG
ffffft11tt0@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Ctii;1Cfftii;,,  .    .,;11i1tfCG
Lfffffttf@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8f11;:,,,,,,,. .,1iittCL
LLLLLffC@@@@@@@@@@@@@@@@@@@@@@@@i,@.   ,G@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Cft;:,,::::,,. ,;1ftfL
LCLLCL0@@@@@@@@@@@@@@@@@@@@@@;,.C@@0itf88@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@GCCL1;:itt;:,;;;1ttLL
CCCCC0@@@@@@@@@@@@@@@@@@@@@::C.   @ @G8G  @@it@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8fi;;1t;;,:;i;tt1tff
GGG08@@@@@@@@@@@@@@@@@@@@@::t.. L. .fft   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8Lfi11;:;:i;iiii1i
8@@@@@@@@@@@@@@@@@@@@@@@@1i1:   @@.@f   @ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8Lfftitt1it1ii;i1"

